{
  "paragraphs": [
    {
      "title": "Spark Version",
      "text": "spark.version",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:56:58.182",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res4: String \u003d 2.3.2\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018182_-968515843",
      "id": "20180405-115412_795640954",
      "dateCreated": "2019-01-04 16:56:58.182",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Python Version",
      "text": "%pyspark\nimport sys\nsys.version",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:56:58.182",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u00273.7.1 (default, Dec 14 2018, 19:28:38) \\n[GCC 7.3.0]\u0027\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018182_-488378945",
      "id": "20181230-135658_379782832",
      "dateCreated": "2019-01-04 16:56:58.182",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Generate Spark Dataframe",
      "text": "%pyspark\n\nheader \u003d [\"id\", \"budget\", \"revenue\", \"runtime\", \"vote_average\", \"release_date\", \"year\", \"title\"]\n\nmovie_list \u003d [\n    [19995,\t237000000,\t2787965087,\t162,\t7.2,\t\"2009-12-10\", 2009, \"Avatar\"],\n    [285,\t300000000,\t961000000,\t169,\t6.9,\t\"2007-05-19\", 2007, \"Pirates of the Caribbean: At World\u0027s End\"],\n    [206647,245000000,\t880674609,\t148,\t6.3,\t\"2015-10-26\", 2015, \"Spectre\"],\n    [49026,\t250000000,\t1084939099,\t165,\t7.6,\t\"2012-07-16\", 2012, \"The Dark Knight Rises\"],\n    [49529,\t260000000,\t284139100,\t132,\t6.1,\t\"2012-03-07\", 2012, \"John Carter\"],\n    [559,\t258000000,\t890871626,\t139,\t5.9,\t\"2007-05-01\", 2007, \"Spider-Man 3\"],\n    [38757,\t260000000,\t591794936,\t100,\t7.4,\t\"2010-11-24\", 2010, \"Tangled\"],\n    [99861,\t280000000,\t1405403694,\t141,\t7.3,\t\"2015-04-22\", 2015, \"Avengers: Age of Ultron\"],\n    [767,\t250000000,\t933959197,\t153,\t7.4,\t\"2009-07-07\", 2009, \"Harry Potter and the Half-Blood Prince\"],\n    [209112,250000000,\t873260194,\t151,\t5.7,\t\"2016-03-23\", 2016, \"Batman v Superman: Dawn of Justice\"],\n    [1452,\t270000000,\t391081192,\t154,\t5.4,\t\"2006-06-28\", 2006, \"Superman Returns\"]\n]",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:56:58.183",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "keys": [],
              "values": [],
              "groups": [],
              "scatter": {}
            }
          }
        ],
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1546621018183_-982021630",
      "id": "20180405-115432_614754846",
      "dateCreated": "2019-01-04 16:56:58.183",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exercise 1 - Load the movie_list into a Spark Dataframe and display/show the first 10 rows",
      "text": "%pyspark\n# https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.SparkSession.createDataFrame\n\n",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:57:11.097",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---------+----------+-------+------------+------------+----+----------------------------------------+\n|id    |budget   |revenue   |runtime|vote_average|release_date|year|title                                   |\n+------+---------+----------+-------+------------+------------+----+----------------------------------------+\n|19995 |237000000|2787965087|162    |7.2         |2009-12-10  |2009|Avatar                                  |\n|285   |300000000|961000000 |169    |6.9         |2007-05-19  |2007|Pirates of the Caribbean: At World\u0027s End|\n|206647|245000000|880674609 |148    |6.3         |2015-10-26  |2015|Spectre                                 |\n|49026 |250000000|1084939099|165    |7.6         |2012-07-16  |2012|The Dark Knight Rises                   |\n|49529 |260000000|284139100 |132    |6.1         |2012-03-07  |2012|John Carter                             |\n|559   |258000000|890871626 |139    |5.9         |2007-05-01  |2007|Spider-Man 3                            |\n|38757 |260000000|591794936 |100    |7.4         |2010-11-24  |2010|Tangled                                 |\n|99861 |280000000|1405403694|141    |7.3         |2015-04-22  |2015|Avengers: Age of Ultron                 |\n|767   |250000000|933959197 |153    |7.4         |2009-07-07  |2009|Harry Potter and the Half-Blood Prince  |\n|209112|250000000|873260194 |151    |5.7         |2016-03-23  |2016|Batman v Superman: Dawn of Justice      |\n+------+---------+----------+-------+------------+------------+----+----------------------------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018183_2139186378",
      "id": "20190104-163430_1739213909",
      "dateCreated": "2019-01-04 16:56:58.183",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exercise 2 - How many records are in the Dataframe?",
      "text": "%pyspark\n# https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.count\n\n",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:57:14.334",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "11\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018183_-1986433202",
      "id": "20190104-163457_837401675",
      "dateCreated": "2019-01-04 16:56:58.183",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exercise 3 - Display descriptive stats using the describe function",
      "text": "%pyspark\n# https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.describe\n\n\n",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:57:19.287",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Describe Dataframe:\n+-------+-----------------+--------------------+--------------------+------------------+------------------+------------+------------------+--------------------+\n|summary|               id|              budget|             revenue|           runtime|      vote_average|release_date|              year|               title|\n+-------+-----------------+--------------------+--------------------+------------------+------------------+------------+------------------+--------------------+\n|  count|               11|                  11|                  11|                11|                11|          11|                11|                  11|\n|   mean|61453.63636363636|               2.6E8|1.0077353394545455E9|146.72727272727272| 6.654545454545455|        null|2010.7272727272727|                null|\n| stddev|78500.09727289862|1.7770762504743572E7|  6.68258258604608E8|19.152498056864065|0.7916610845098253|        null|3.5239440713754036|                null|\n|    min|              285|           237000000|           284139100|               100|               5.4|  2006-06-28|              2006|              Avatar|\n|    max|           209112|           300000000|          2787965087|               169|               7.6|  2016-03-23|              2016|The Dark Knight R...|\n+-------+-----------------+--------------------+--------------------+------------------+------------------+------------+------------------+--------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018184_218999893",
      "id": "20181230-181122_1988789482",
      "dateCreated": "2019-01-04 16:56:58.184",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exercise 4 - Filter the Dataframe where vote_average greater or equal to 7 AND year is greater than 2009",
      "text": "%pyspark\n# https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.filter\n\n",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:57:24.504",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+---------+----------+-------+------------+------------+----+-----------------------+\n|id   |budget   |revenue   |runtime|vote_average|release_date|year|title                  |\n+-----+---------+----------+-------+------------+------------+----+-----------------------+\n|49026|250000000|1084939099|165    |7.6         |2012-07-16  |2012|The Dark Knight Rises  |\n|38757|260000000|591794936 |100    |7.4         |2010-11-24  |2010|Tangled                |\n|99861|280000000|1405403694|141    |7.3         |2015-04-22  |2015|Avengers: Age of Ultron|\n+-----+---------+----------+-------+------------+------------+----+-----------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018184_-1089070406",
      "id": "20181230-183035_202931985",
      "dateCreated": "2019-01-04 16:56:58.184",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exercise 5 - Group by year. Find the vote_average per year AND find the number of movies per year.",
      "text": "%pyspark\n# https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.groupBy\n\n",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:57:31.542",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+-----------------+--------+\n|year|avg(vote_average)|count(1)|\n+----+-----------------+--------+\n|2010|7.4              |1       |\n|2009|7.300000000000001|2       |\n|2012|6.85             |2       |\n|2015|6.8              |2       |\n|2007|6.4              |2       |\n|2016|5.7              |1       |\n|2006|5.4              |1       |\n+----+-----------------+--------+\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018184_688742486",
      "id": "20181230-183051_909720466",
      "dateCreated": "2019-01-04 16:56:58.184",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exercise 6 - Load a CSV file into a Spark Dataframe (located here: file:///data/tmdb_5000_movies.csv)",
      "text": "%pyspark\n# https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrameReader\n\n",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 17:15:14.592",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Number of records in movie_df: 4800\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018184_1149010451",
      "id": "20181230-172756_369647197",
      "dateCreated": "2019-01-04 16:56:58.184",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exercise 7 - Load the DF that you just created into a Spark temporary table (so that we can query the table using SparkSQL)",
      "text": "%pyspark\n# https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.createOrReplaceTempView\n\n\n",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 17:15:28.252",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1546621018185_1181041768",
      "id": "20190104-165115_1098676142",
      "dateCreated": "2019-01-04 16:56:58.185",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exercise 8 - Use SparkSQL to query the temporary table that you just loaded in the previous step",
      "text": "%sql\n\n",
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:57:45.279",
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/sql",
        "fontSize": 9.0,
        "title": true,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "keys": [],
              "values": [],
              "groups": [],
              "scatter": {},
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "id": "string",
                      "budget": "string",
                      "title": "string",
                      "revenue": "string",
                      "runtime": "string",
                      "vote_average": "string",
                      "release_date": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        ],
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "id\tbudget\ttitle\trevenue\truntime\tvote_average\trelease_date\n19995\t237000000\tAvatar\t2787965087\t162\t7.2\t2009-12-10\n285\t300000000\tPirates of the Caribbean: At World\u0027s End\t961000000\t169\t6.9\t2007-05-19\n206647\t245000000\tSpectre\t880674609\t148\t6.3\t2015-10-26\n49026\t250000000\tThe Dark Knight Rises\t1084939099\t165\t7.6\t2012-07-16\n49529\t260000000\tJohn Carter\t284139100\t132\t6.1\t2012-03-07\n559\t258000000\tSpider-Man 3\t890871626\t139\t5.9\t2007-05-01\n38757\t260000000\tTangled\t591794936\t100\t7.4\t2010-11-24\n99861\t280000000\tAvengers: Age of Ultron\t1405403694\t141\t7.3\t2015-04-22\n767\t250000000\tHarry Potter and the Half-Blood Prince\t933959197\t153\t7.4\t2009-07-07\n209112\t250000000\tBatman v Superman: Dawn of Justice\t873260194\t151\t5.7\t2016-03-23\n1452\t270000000\tSuperman Returns\t391081192\t154\t5.4\t2006-06-28\n10764\t200000000\tQuantum of Solace\t586090727\t106\t6.1\t2008-10-30\n58\t200000000\tPirates of the Caribbean: Dead Man\u0027s Chest\t1065659812\t151\t7.0\t2006-06-20\n57201\t255000000\tThe Lone Ranger\t89289910\t149\t5.9\t2013-07-03\n49521\t225000000\tMan of Steel\t662845518\t143\t6.5\t2013-06-12\n2454\t225000000\tThe Chronicles of Narnia: Prince Caspian\t419651413\t150\t6.3\t2008-05-15\n24428\t220000000\tThe Avengers\t1519557910\t143\t7.4\t2012-04-25\n1865\t380000000\tPirates of the Caribbean: On Stranger Tides\t1045713802\t136\t6.4\t2011-05-14\n41154\t225000000\tMen in Black 3\t624026776\t106\t6.2\t2012-05-23\n122917\t250000000\tThe Hobbit: The Battle of the Five Armies\t956019788\t144\t7.1\t2014-12-10\n1930\t215000000\tThe Amazing Spider-Man\t752215857\t136\t6.5\t2012-06-27\n20662\t200000000\tRobin Hood\t310669540\t140\t6.2\t2010-05-12\n57158\t250000000\tThe Hobbit: The Desolation of Smaug\t958400000\t161\t7.6\t2013-12-11\n2268\t180000000\tThe Golden Compass\t372234864\t113\t5.8\t2007-12-04\n254\t207000000\tKing Kong\t550000000\t187\t6.6\t2005-12-14\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1546621018185_-1554628635",
      "id": "20180405-115744_153060313",
      "dateCreated": "2019-01-04 16:56:58.185",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    },
    {
      "user": "anonymous",
      "dateUpdated": "2019-01-04 16:56:58.186",
      "config": {
        "editorSetting": {
          "language": "scala"
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "results": {},
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1546621018185_1431222751",
      "id": "20180405-123344_2115651552",
      "dateCreated": "2019-01-04 16:56:58.185",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Getting Started - Python 1 (lab)",
  "id": "2DYMNH1KS",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}